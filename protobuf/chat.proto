syntax = "proto3";

import "google/protobuf/timestamp.proto";

package chat;

service Chat {
    rpc GetUserChats (UserId) returns (MultipleChats) {}
    rpc CreateChat (CreateChatRequest) returns (ChatId) {}
    rpc UpdateChat (UpdateChatRequest) returns (ChatId) {}
    rpc GetChatData (ChatId) returns (ChatData) {}
    rpc DeleteUserChat (DeleteUserFromChatRequest) returns (DeleteResponse) {}
    rpc DeleteChat (ChatId) returns (DeleteResponse) {}

}

message ChatId {
    int32 id = 1;
}

message UserId {
    int32 id = 1;
}

message ChatResponse {
    int32 id = 1;
    string name = 2;
    optional string avatar = 3;
    optional string last_message = 4;
    optional google.protobuf.Timestamp last_message_at = 5;
}

message MultipleChats {
    repeated ChatResponse chats = 1;
}

message CreateChatRequest {
    string name = 1;
    repeated UserId members = 2;
}

message UpdateChatRequest {
    int32 id = 1;
    optional string name = 2;
    optional string avatar = 3;
    repeated UserId members = 4;
}

message ChatData {
    int32 id = 1;
    string name = 2;
    optional string avatar = 3;
    optional string last_message = 4;
    optional google.protobuf.Timestamp last_message_at = 5;
    repeated UserId members = 6;
    google.protobuf.Timestamp created_at = 7;
}

message DeleteUserFromChatRequest {
    int32 user_id = 1;
    int32 chat_id = 2;
}

message DeleteResponse {
    string status = 1;
}
