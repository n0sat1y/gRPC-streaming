syntax = "proto3";

import "google/protobuf/timestamp.proto";

package message;

service MessageService {
    rpc SendMessage (SendMessageRequest) returns (SendMessageResponse) {}
    rpc UpdateMessage (UpdateMessageRequest) returns (MessageId) {}
    rpc DeleteMessage (DeleteMessageRequest) returns (DeleteMessageResponse) {}
    rpc GetAllMessages (GetAllMessagesRequest) returns (AllMessages) {}
}

message MessageId {
    string message_id = 1;
}

message SendMessageRequest {
    int32 user_id = 1;
    int32 chat_id = 3;
    string content = 4;
    string request_id = 5;
    int32 sender_id = 6;
}

message SendMessageResponse {
    string message_id = 2;
    google.protobuf.Timestamp created_at = 3;
}

message UpdateMessageRequest {
    string message_id = 1;
    string new_content = 2;
    string request_id = 3;
    int32 sender_id = 4;
}

message DeleteMessageRequest {
    string message_id = 1;
    string request_id = 2;
    int32 sender_id = 3;
}

message DeleteMessageResponse {
    string status = 1;
}

message SenderData {
    int32 id = 3;
    string username = 4;
}

message Message {
    string id = 1;
    int32 chat_id = 2;
    SenderData sender = 3;
    string content = 4;
    bool is_read = 5;
    google.protobuf.Timestamp created_at = 6;
}

message GetAllMessagesRequest {
    int32 chat_id = 1;
}

message AllMessages {
    repeated Message messages = 1;
}
